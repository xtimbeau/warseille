---
  author:
    - name: Xavier Timbeau
    - name: Maxime Parodi
---


```{r init, include=FALSE}
source("init.R")
```

# Du potentiel de l'accessibilité aux trajets effectifs

L'indicateur d'accessibilité permet d'évaluer le potentiel. La modélisation des flux et leur calage sur les flux intercommunaux issus de MOBPRO permet de réaliser ce passage. Il est est difficile de dire qu'un indicateur est supérieur systématiquement à l'autre. Les flux sont la bonne source pour imputer les émissions de GES à chaque ménage de chaque carreau. L'accessibilité intéresse l'urbaniste pour évaluer l'attractivité d'un territoire ou participe à expliquer le gradient de prix sur les territoires. A priori, on attend plus de contraste pour l'accessibilité, les comportements ayant tendance à transférer les différences d'accessibilité sur d'autres dimensions. Ainsi, un individu disposant d'une faible accessibilité aura sans doute un emploi proche de chez lui, qu'il ait choisi l'emploi en fonction de l'endroit où il habite ou l'endroit où il habite en fonction de l'emploi qu'il a trouvé. En revanche, le potentiel ne dit rien sur le tri spatial qui est opéré sur le territoire. Tous les ménages ne sont pas uniformément répartis sur le territoire mais sont fortement ségrégés spatialement suivant certaines caractéristiques, en particulier le revenu et le nombre d'enfants.

## Méthode

La méthode employée suit celle développée dans @meaps2024b et mise en oeuvre à la Rochelle [@lempérière2023].

La **première étape** consiste à prendre en compte la géographie du territoire par la localisation au carreau 200m des résidents et des emplois (voir les parties sur [les localisations](localisations.qmd) et [l'accessibilité](accessibilites.qmd)). Ces localisations sont ensuite reliées par les réseaux de transport, pour 4 modes \[marche, vélo, transport en commun, voiture\]. A ce stade la voiture n'intègre pas la congestion, les données proposées par Mapbox le permettraient.

La **seconde étape** consiste à utiliser MEAPS [@meaps2023] pour générer les flux d'un carreau à l'autre. MEAPS permet de reproduire avec un faible nombre de paramètres [@meaps2024a] les données intercommunales issues de la mobilité professionnelle quotidienne (MOBPRO) et de respecter les équilibres d'ensemble (un emploi reçoit un actif, chaque actif a un emploi). Du fait de ces propriétés, il est possible d'utiliser MEAPS pour intrapoler à une échelle géographique fine (celle de la première étape) les flux.

La **troisième étape** associe aux flux les fréquences, la complexité des boucle et le mode de transport. Cette analyse est également conduite au niveau fin du carreau 200m, pour différentes catégories de ménage. Les catégories de ménages sont identifiées soit à l'IRIS soit à la commune et sont intrapolées à partir des données carroyées de l'INSEE (pour l'année 2019) [@meaps2024b]. En multipliant les flux, les fréquences, les complexités de boucles, les modes, les distances entre le domicile et le travail on obtient alors un estimateur des kilomètres parcourus. On passe ensuite du nombre de kilomètres au CO~2~ par l'application d'un coefficient uniforme[^trajets-1] indiquant le contenu en CO~2~ d'un kilomètre en moyenne pour une voiture aux kilomètres parcourus en voiture.

[^trajets-1]: Le SDES a publié récemment une version enrichie de l'EMP 2019 en intégrant des coefficients d'émission de CO~2~ pour les véhicules possédés par les ménages. Jusqu'à maintenant cette information était déclarative et très approximative. Cette information est plus riche et sera prochainement intégrée, si possible.

A ce stade, les modèles estimés le sont sur les données de l'Enquête Mobilités des Personnes (EMP 2019), hors Ile de France. Dans une prochaine étape, nous utiliserons l'EMC^2^ à titre de comparaison, sous réserve que l'EMC^2^ permettent les mêmes analyses.

## Carte des émissions de CO~2~ pour les mobilités professionnelles

::::: {#fig-carteco2}
:::: {.column-screen}
:::{.panel-tabset}

## Carte interactive

```{r}
library(colourvalues)
pal <- grDevices::colorRamp(c("royalblue1","springgreen", "yellow1","orange", "orangered"), bias =1)( (0:4)/4)
color_txxk <- function(x, min = 1, max = 5, palette = pal) color_values(c(min, max, trim(x, min, max)), palette=palette) |> tail(-2)
legend <- color_values(1:5, palette = pal, summary=TRUE, n_summaries=5)
le <- legend_element(as.integer(legend$summary_values), legend$summary_colours, "fill", "gradient", "tCO2/an") |> 
  mapdeck_legend()
communes <- bd_read("communes") |> 
  st_drop_geometry() |>
  select(com=INSEE_COM, NOM, POPULATION) 
bd_read("meaps_from") |> 
  drop_na(co2_pa) |> 
  left_join(communes, by="com") |> 
  transmute(
    co2_pa=co2_pa,
    co2_i,
    f_i,
    tooltip=glue::glue(
    "{NOM} {com}<br>
     {round(f_i)} actifs dans le carreau<br>
     {POPULATION} dans la commune<br>
     CO2 pro par actif: {round(co2_pa,1)} tCO2/an<br>"),
    cco2 = color_txxk(co2_pa)) |> 
  st_transform(4326) |> 
  mapdeck(style = style,
          height = "50vh",
          width = "100%") |> 
  add_polygon(fill_colour = "cco2", 
              elevation = "co2_i", 
              elevation_scale = 3, 
              legend = le, 
              tooltip = "tooltip") |> 
  mapdeck_view(location = centre, zoom = 9, pitch = 0, bearing = 0)
```

## Carte statique

```{r}
bd_read("carte_co2") +
  theme_ofce_void() +
  theme(legend.position = "bottom", legend.key.height = unit(6, "pt")) +
  labs(caption="*Source* : MOBPRO, EMP 2019, C200, OSM, GTFS,  MEAPS.<br>**v2**")

```
:::
Emissions de CO~2~ localisées, Aix Marseille Provence Métropole
::::
:::::

```{r}
download_this(
  bd_read("meaps_from") |> 
    st_drop_geometry(),
  icon = "fa fa-download",
  class = "dbtn",
  button_label = "données CO2 au carreau",
  output_name = "co2_idINS_MetAM"
)
```

## Références bibliographiques  {.unnumbered}

::: {#refs}
:::
